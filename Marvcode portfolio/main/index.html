<script type="module">
import { openDB, deleteDB } from 'https://unpkg.com/idb?module'
</script>
<script>
    (() => {
            'use strict'

            if (!('indexedDB' in window)) {
                console.warn('IndexedDB not supported')
                return
            }

            //...IndexedDB code
        })()
        (async () => {
            //...

            const dbName = 'mydbname'
            const storeName = 'store1'
            const version = 1 //versions start at 1

            const db = await openDB(dbName, version, {
                upgrade(db, oldVersion, newVersion, transaction) {
                    const store = db.createObjectStore(storeName)
                }
            })
        })()
        
        (async () => {
            //...
            const dbName = 'mydbname'
            const storeName = 'store0'
            const version = 1

            const db = await openDB(dbName, version, {
                upgrade(db, oldVersion, newVersion, transaction) {
                    const store = db.createObjectStore(storeName)
                    store.put('Hello world!', 'Hello')
                }
            })
        })()
        (async () => {
            //...
            const dbName = 'mydbname'
            const storeName = 'store0'
            const version = 1

            const db = await openDB(/* ... */)

            const tx = db.transaction(storeName, 'readwrite')
            const store = await tx.objectStore(storeName)

            const val = 'hey!'
            const key = 'Hello again'
            const value = await store.put(val, key)
            await tx.done
        })()
        const key = 'Hello again'
        const item = await db.transaction(storeName).objectStore(storeName).get(key)
        const dbName = 'mydbname'
        await deleteDB(dbName)
        (async () => {
                //...

                const dbName = 'mydbname'
                const storeName = 'store1'
                const version = 1

                const db = await openDB(dbName, version, {
                    upgrade(db, oldVersion, newVersion, transaction) {
                        const store = db.createObjectStore(storeName)
                    }
                })

                const tx = await db.transaction(storeName, 'readwrite')
                const store = await tx.objectStore(storeName)

                const key = 'Hello again'
                await store.delete(key)
                await tx.done
            })()
            const name = 'mydbname'
                const version = 1
                openDB(name, version, {
                    upgrade(db, oldVersion, newVersion, transaction) {
                        console.log(oldVersion)
                    }
                })
                (async () => {
                        //...
                        const dbName = 'mydbname'
                        const storeName = 'store0'
                        const version = 1

                        const db = await openDB(dbName, version, {
                            upgrade(db, oldVersion, newVersion, transaction) {
                                switch (oldVersion) {
                                    case 0: // no db created before
                                        // a store introduced in version 1
                                        db.createObjectStore('store1')
                                    case 1:
                                        // a new store in version 2
                                        db.createObjectStore('store2', { keyPath: 'name' })
                                }
                                db.createObjectStore(storeName)
                            }
                        })
                    })()
                    db.createObjectStore('notes', { autoIncrement: true })

</script>